# DeepAgents Custom å¼€å‘æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ DeepAgents Custom é¡¹ç›®ä¸­è¿›è¡Œæ—¥å¸¸å¼€å‘ã€åŒæ­¥å®˜æ–¹æ›´æ–°ä»¥åŠå›¢é˜Ÿåä½œã€‚

## ğŸ“š ç›®å½•

1. [ä»“åº“ç»“æ„](#ä»“åº“ç»“æ„)
2. [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
3. [æ—¥å¸¸å¼€å‘æµç¨‹](#æ—¥å¸¸å¼€å‘æµç¨‹)
4. [åŒæ­¥å®˜æ–¹æ›´æ–°](#åŒæ­¥å®˜æ–¹æ›´æ–°)
5. [å›¢é˜Ÿåä½œ](#å›¢é˜Ÿåä½œ)
6. [å‘å¸ƒæµç¨‹](#å‘å¸ƒæµç¨‹)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ä»“åº“ç»“æ„

### Remote é…ç½®

```bash
origin   â†’ https://github.com/yefengzi7/deepagents_custom.git (ä½ çš„ä»“åº“)
upstream â†’ https://github.com/langchain-ai/deepagents.git (å®˜æ–¹ä»“åº“)
```

### åˆ†æ”¯ç­–ç•¥

```
master (å—ä¿æŠ¤)
  â”œâ”€ ä¸å®˜æ–¹ deepagents ä¿æŒåŒæ­¥
  â””â”€ ä»…å‘å¸ƒç¨³å®šç‰ˆæœ¬

dev (å¼€å‘ä¸»åˆ†æ”¯)
  â”œâ”€ æ—¥å¸¸å¼€å‘é›†æˆ
  â””â”€ åŒ…å«å·²å®Œæˆçš„åŠŸèƒ½

feature/* (åŠŸèƒ½åˆ†æ”¯)
  â””â”€ ä¸ªäººå¼€å‘æ–°åŠŸèƒ½
```

---

## å¼€å‘ç¯å¢ƒè®¾ç½®

### é¦–æ¬¡å…‹éš†

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yefengzi7/deepagents_custom.git
cd deepagents_custom

# æ·»åŠ å®˜æ–¹ä»“åº“ä¸º upstreamï¼ˆå¯é€‰ï¼Œå¦‚æœä½ æƒ³è‡ªå·±åŒæ­¥å®˜æ–¹æ›´æ–°ï¼‰
git remote add upstream https://github.com/langchain-ai/deepagents.git
```

### ç¯å¢ƒé…ç½®

```bash
# åˆ‡æ¢åˆ° dev åˆ†æ”¯
git checkout dev

# è¿›å…¥æ ¸å¿ƒåº“ç›®å½•
cd libs/deepagents

# ä½¿ç”¨ uv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
uv sync

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
.venv\Scripts\activate
# Linux/Mac:
source .venv/bin/activate
```

### éªŒè¯å®‰è£…

```bash
# è¿è¡Œæµ‹è¯•
pytest tests/

# æ£€æŸ¥ä¸­é—´ä»¶
python -c "from deepagents.middleware import au2_compression; print('OK')"
```

---

## æ—¥å¸¸å¼€å‘æµç¨‹

### æ­¥éª¤1ï¼šåˆ›å»ºåŠŸèƒ½åˆ†æ”¯

```bash
# ç¡®ä¿åœ¨ dev åˆ†æ”¯å¹¶æ‹‰å–æœ€æ–°ä»£ç 
git checkout dev
git pull origin dev

# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼ˆå‘½åè§„èŒƒï¼šfeature/åŠŸèƒ½æè¿°ï¼‰
git checkout -b feature/my-awesome-middleware
```

### æ­¥éª¤2ï¼šå¼€å‘ä½ çš„åŠŸèƒ½

åœ¨ `libs/deepagents/deepagents/middleware/` ç›®å½•ä¸‹å¼€å‘ä½ çš„ä¸­é—´ä»¶ï¼š

```bash
# ä¾‹å¦‚ï¼šåˆ›å»ºæ–°çš„ä¸­é—´ä»¶
libs/deepagents/deepagents/middleware/
â”œâ”€â”€ __init__.py           # è®°å¾—åœ¨è¿™é‡Œå¯¼å‡ºä½ çš„ä¸­é—´ä»¶
â”œâ”€â”€ my_middleware.py      # ä½ çš„ä¸­é—´ä»¶ä»£ç 
â””â”€â”€ ...
```

**å¼€å‘è§„èŒƒ**ï¼š
- éµå¾ªç°æœ‰ä»£ç é£æ ¼ï¼ˆä½¿ç”¨ `ruff` æ£€æŸ¥ï¼‰
- ç¼–å†™å•å…ƒæµ‹è¯•åœ¨ `libs/deepagents/tests/unit_tests/middleware/`
- æ›´æ–° `__init__.py` å¯¼å‡ºä½ çš„ä¸­é—´ä»¶

### æ­¥éª¤3ï¼šç¼–å†™æµ‹è¯•

```bash
# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
libs/deepagents/tests/unit_tests/middleware/test_my_middleware.py
```

ç¤ºä¾‹æµ‹è¯•ï¼š
```python
import pytest
from deepagents.middleware.my_middleware import MyMiddleware

def test_my_middleware():
    middleware = MyMiddleware()
    # ä½ çš„æµ‹è¯•é€»è¾‘
    assert middleware is not None
```

### æ­¥éª¤4ï¼šè¿è¡Œæµ‹è¯•å’Œä»£ç æ£€æŸ¥

```bash
# è¿›å…¥æ ¸å¿ƒåº“ç›®å½•
cd libs/deepagents

# è¿è¡Œæµ‹è¯•
pytest tests/unit_tests/middleware/test_my_middleware.py

# ä»£ç æ ¼å¼æ£€æŸ¥å’Œä¿®å¤
ruff check .
ruff format .

# ç±»å‹æ£€æŸ¥
mypy deepagents/middleware/my_middleware.py
```

### æ­¥éª¤5ï¼šæäº¤ä»£ç 

```bash
# æ·»åŠ ä¿®æ”¹
git add .

# æäº¤ï¼ˆä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯ï¼‰
git commit -m "feat: add my awesome middleware

- Implemented core middleware logic
- Added unit tests
- Updated documentation
"

# æ¨é€åˆ°è¿œç¨‹
git push origin feature/my-awesome-middleware
```

### æ­¥éª¤6ï¼šåˆ›å»º Pull Request

1. è®¿é—® https://github.com/yefengzi7/deepagents_custom
2. ç‚¹å‡» "Pull requests" â†’ "New pull request"
3. é€‰æ‹©ï¼š`feature/my-awesome-middleware` â†’ `dev`
4. å¡«å†™ PR æè¿°ï¼š
   - åŠŸèƒ½è¯´æ˜
   - æŠ€æœ¯å®ç°
   - æµ‹è¯•è¦†ç›–
5. ç­‰å¾…ä»£ç å®¡æŸ¥

---

## åŒæ­¥å®˜æ–¹æ›´æ–°

### æ–¹å¼1ï¼šç»´æŠ¤è€…ç»Ÿä¸€åŒæ­¥ï¼ˆæ¨èï¼‰

ç”±é¡¹ç›®ç»´æŠ¤è€…å®šæœŸåŒæ­¥å®˜æ–¹æ›´æ–°å¹¶æ¨é€åˆ°å›¢é˜Ÿä»“åº“ã€‚

```bash
# 1. åˆ‡æ¢åˆ° dev åˆ†æ”¯
git checkout dev

# 2. è·å–å®˜æ–¹æœ€æ–°ä»£ç 
git fetch upstream

# 3. æŸ¥çœ‹å®˜æ–¹æ›´æ–°å†…å®¹ï¼ˆå¯é€‰ï¼‰
git log dev..upstream/master --oneline

# 4. åˆå¹¶å®˜æ–¹æ›´æ–°
git merge upstream/master

# 5. è§£å†³å†²çªï¼ˆå¦‚æœæœ‰ï¼‰
# ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œç„¶åï¼š
git add .
git commit -m "chore: merge upstream updates"

# 6. è¿è¡Œæµ‹è¯•ç¡®ä¿å…¼å®¹æ€§
pytest tests/

# 7. æ¨é€åˆ°å›¢é˜Ÿä»“åº“
git push origin dev

# 8. åŒæ­¥åˆ° masterï¼ˆå¯é€‰ï¼Œå¦‚æœæµ‹è¯•é€šè¿‡ï¼‰
git checkout master
git merge upstream/master
git push origin master
```

### æ–¹å¼2ï¼šä¸ªäººè‡ªè¡ŒåŒæ­¥

å›¢é˜Ÿæˆå‘˜ä¹Ÿå¯ä»¥è‡ªå·±åŒæ­¥å®˜æ–¹æ›´æ–°ï¼š

```bash
# 1. æ·»åŠ  upstreamï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
git remote add upstream https://github.com/langchain-ai/deepagents.git

# 2. ä»è‡ªå·±çš„åŠŸèƒ½åˆ†æ”¯æ“ä½œ
git checkout feature/my-feature
git fetch upstream
git merge upstream/master

# 3. è§£å†³å†²çªå¹¶æµ‹è¯•
# ...

# 4. æ¨é€åˆ°è‡ªå·±çš„åŠŸèƒ½åˆ†æ”¯
git push origin feature/my-feature
```

### åŒæ­¥ç­–ç•¥å»ºè®®

- **å®šæœŸåŒæ­¥**ï¼šæ¯å‘¨å›ºå®šæ—¶é—´æ£€æŸ¥å®˜æ–¹æ›´æ–°
- **é‡å¤§æ›´æ–°å‰åŒæ­¥**ï¼šåˆå¹¶åŠŸèƒ½åˆ° dev å‰å…ˆåŒæ­¥å®˜æ–¹
- **å‘å¸ƒå‰åŒæ­¥**ï¼šå‘å¸ƒæ–°ç‰ˆæœ¬å‰ç¡®ä¿åŒ…å«æœ€æ–°å®˜æ–¹ä¿®å¤

---

## å›¢é˜Ÿåä½œ

### å…‹éš†ä»“åº“ï¼ˆæ–°æˆå‘˜ï¼‰

```bash
# å…‹éš†å›¢é˜Ÿä»“åº“
git clone https://github.com/yefengzi7/deepagents_custom.git
cd deepagents_custom

# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
git branch -a

# åˆ‡æ¢åˆ° dev
git checkout dev

# è®¾ç½®ç¯å¢ƒ
cd libs/deepagents
uv sync
```

### æ—¥å¸¸åä½œæµç¨‹

```bash
# æ¯å¤©å¼€å§‹å·¥ä½œå‰
git checkout dev
git pull origin dev

# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature

# å¼€å‘...

# æäº¤å¹¶æ¨é€
git push origin feature/your-feature

# åˆ›å»º PR åˆ° dev
```

### ä»£ç å®¡æŸ¥è§„èŒƒ

**PR æäº¤è€…**ï¼š
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
- ä»£ç ç¬¦åˆ ruff è§„èŒƒ
- æä¾›æ¸…æ™°çš„ PR æè¿°

**å®¡æŸ¥è€…**ï¼š
- æ£€æŸ¥ä»£ç è´¨é‡å’Œé€»è¾‘
- éªŒè¯æµ‹è¯•è¦†ç›–ç‡
- æå‡ºæ”¹è¿›å»ºè®®

---

## å‘å¸ƒæµç¨‹

### å‡†å¤‡å‘å¸ƒ

```bash
# 1. ç¡®ä¿ dev åˆ†æ”¯ç¨³å®š
git checkout dev
pytest tests/

# 2. æ›´æ–°ç‰ˆæœ¬å·
# ç¼–è¾‘ libs/deepagents/pyproject.toml
# version = "0.3.0"  # æŒ‰ç…§è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ

# 3. æ›´æ–° CHANGELOGï¼ˆå¦‚æœæœ‰ï¼‰
```

### å‘å¸ƒåˆ° master

```bash
# 1. åˆ‡æ¢åˆ° master
git checkout master

# 2. åˆå¹¶ dev
git merge dev

# 3. æ‰“æ ‡ç­¾
git tag -a v0.3.0 -m "Release v0.3.0: Add custom middlewares"

# 4. æ¨é€åˆ°è¿œç¨‹
git push origin master --tags
```

### å‘å¸ƒåˆ° PyPIï¼ˆå¯é€‰ï¼‰

```bash
cd libs/deepagents

# æ„å»ºåŒ…
uv build

# å‘å¸ƒï¼ˆéœ€è¦ PyPI è´¦å·ï¼‰
uv publish
```

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æŸ¥çœ‹æˆ‘çš„ remote é…ç½®ï¼Ÿ

```bash
git remote -v
```

### Q2: åˆå¹¶æ—¶é‡åˆ°å†²çªæ€ä¹ˆåŠï¼Ÿ

```bash
# 1. æŸ¥çœ‹å†²çªæ–‡ä»¶
git status

# 2. ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œæ‰‹åŠ¨è§£å†³å†²çªæ ‡è®°
# <<<<<<< HEAD
# ä½ çš„ä»£ç 
# =======
# å®˜æ–¹ä»£ç 
# >>>>>>> upstream/master

# 3. æ ‡è®°ä¸ºå·²è§£å†³
git add å†²çªæ–‡ä»¶

# 4. ç»§ç»­åˆå¹¶
git commit
```

### Q3: å¦‚ä½•æ’¤é”€æœªæ¨é€çš„æäº¤ï¼Ÿ

```bash
# æ’¤é”€æœ€åä¸€æ¬¡æäº¤ï¼Œä½†ä¿ç•™ä¿®æ”¹
git reset --soft HEAD~1

# æ’¤é”€æœ€åä¸€æ¬¡æäº¤ï¼Œä¸¢å¼ƒä¿®æ”¹
git reset --hard HEAD~1
```

### Q4: å¦‚ä½•åªä½¿ç”¨ deepagents ç¯å¢ƒï¼Ÿ

ç›®å‰ä¸‰ä¸ªé¡¹ç›®ï¼ˆdeepagentsã€deepagents-cliã€harborï¼‰éƒ½æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒï¼Œä½†**å¼€å‘ä¸­é—´ä»¶åªéœ€è¦ `libs/deepagents/.venv`**ã€‚

```bash
cd libs/deepagents
.venv\Scripts\activate  # Windows
```

### Q5: ç°æœ‰çš„ä¸‰ä¸ªç›®å½•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- `libs/deepagents/`ï¼šæ ¸å¿ƒåº“ï¼Œ**åœ¨è¿™é‡Œå¼€å‘ä¸­é—´ä»¶**
- `libs/deepagents-cli/`ï¼šCLI å·¥å…·ï¼Œä¾èµ–æ ¸å¿ƒåº“
- `libs/harbor/`ï¼šHarbor é›†æˆï¼Œä¾èµ–æ ¸å¿ƒåº“

### Q6: å¦‚ä½•æ›´æ–°æˆ‘çš„åŠŸèƒ½åˆ†æ”¯åˆ°æœ€æ–°çš„ devï¼Ÿ

```bash
git checkout feature/my-feature
git fetch origin
git merge origin/dev
```

---

## é™„å½•

### é¡¹ç›®ç»“æ„

```
deepagents_custom/
â”œâ”€â”€ libs/
â”‚   â”œâ”€â”€ deepagents/              # æ ¸å¿ƒåº“ï¼ˆå¼€å‘é‡ç‚¹ï¼‰
â”‚   â”‚   â”œâ”€â”€ deepagents/
â”‚   â”‚   â”‚   â””â”€â”€ middleware/      # ä¸­é—´ä»¶ç›®å½•
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ au2_compression.py  # ä½ çš„ä¸­é—´ä»¶
â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ docs/                # æœ¬æ–‡æ¡£æ‰€åœ¨ä½ç½®
â”‚   â”‚   â””â”€â”€ pyproject.toml
â”‚   â”œâ”€â”€ deepagents-cli/          # CLI å·¥å…·
â”‚   â””â”€â”€ harbor/                  # Harbor é›†æˆ
â””â”€â”€ README.md
```

### æ¨èå·¥å…·

- **IDE**: VS Code / PyCharm
- **Git å®¢æˆ·ç«¯**: Git CLI / GitHub Desktop
- **Python ç‰ˆæœ¬ç®¡ç†**: pyenv
- **åŒ…ç®¡ç†**: uv

---

**æœ€åæ›´æ–°**: 2025-12-08
**ç»´æŠ¤è€…**: @yefengzi7
